id: org.wine.App
branch: stable
sdk: org.wine.Sdk
runtime: org.wine.Platform
runtime-version: '10.0'
finish-args:
  - --allow=multiarch               # Access to 32bit libraries (for running 32bit executables)
  - --socket=wayland                # Access to Wayland socket for display
  - --socket=fallback-x11           # Access to X11 socket for display (incase wayland doesn't work)
  - --socket=pulseaudio             # Access to pulse audio socket for sound
  - --env=WINEPREFIX=/var/data/wine # Set prefix location
  # - --env=WINEARCH=win32            # Set Wine to 32bit mode (64bit mode is default)
inherit-extensions:
  - org.freedesktop.Platform.Compat.i386       # 32bit Linux compatibility
  - org.freedesktop.Platform.Compat.i386.Debug # 32bit Linux compatibility debug
  - org.freedesktop.Platform.GL                # OpenGL
  - org.freedesktop.Platform.GL32              # 32bit OpenGL
  - org.freedesktop.Platform.GL32.Debug        # 32bit OpenGL Debug
  - org.freedesktop.Platform.VAAPI.Intel.i386  # 32bit Intel VAAPI
  - org.freedesktop.Platform.ffmpeg-full       # FFmpeg
  - org.freedesktop.Platform.ffmpeg_full.i386  # 32bit FFmpeg
cleanup-commands:
  # Make directories needed by extensions
  - mkdir -p ${FLATPAK_DEST}/lib/i386-linux-gnu                        # 32bit Linux compatibility
  - mkdir -p ${FLATPAK_DEST}/lib/debug/lib/i386-linux-gnu              # 32bit Linux compatibility debug
  - mkdir -p ${FLATPAK_DEST}/lib/x86_64-linux-gnu/GL                   # OpenGL
  - mkdir -p ${FLATPAK_DEST}/lib/i386-linux-gnu/GL                     # 32bit OpenGL
  - mkdir -p ${FLATPAK_DEST}/lib/debug/lib/i386-linux-gnu/GL           # 32bit OpenGL Debug
  - mkdir -p ${FLATPAK_DEST}/lib/i386-linux-gnu/dri/intel-vaapi-driver # 32bit Intel VAAPI
  - mkdir -p ${FLATPAK_DEST}/lib/ffmpeg                                # FFmpeg
  - mkdir -p ${FLATPAK_DEST}/lib32/ffmpeg                              # 32bit FFmpeg
modules:
  - name: App
    buildsystem: simple
    sources:
      - type: file
        path: org.wine.App.metainfo.xml
    build-commands:
      - |
        install -Dm644 org.wine.App.metainfo.xml -t ${FLATPAK_DEST}/share/metainfo

